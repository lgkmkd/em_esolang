todo:

- fix labels and jumps
- improve kernel
- 